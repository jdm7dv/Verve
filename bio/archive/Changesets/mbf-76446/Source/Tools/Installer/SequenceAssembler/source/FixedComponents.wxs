<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <ComponentGroup Id="FileAssociations">

      <ComponentRef Id="Fasta_FaFileAssociation" />
      <ComponentRef Id="Fasta_MpfaFileAssociation" />
      <ComponentRef Id="Fasta_FnaFileAssociation" />
      <ComponentRef Id="Fasta_FaaFileAssociation" />
      <ComponentRef Id="Fasta_FsaFileAssociation" />
      <ComponentRef Id="Fasta_FasFileAssociation" />
      <ComponentRef Id="Fasta_FastaFileAssociation" />


      <ComponentRef Id="Fastq_FqFileAssociation" />
      <ComponentRef Id="Fastq_FastqFileAssociation" />
      
      <ComponentRef Id="GffFileAssociation" />

      <ComponentRef Id="Genbank_GbFileAssociation" />
      <ComponentRef Id="Genbank_GbkFileAssociation" />
      <ComponentRef Id="Genbank_GenbankFileAssociation" />
    </ComponentGroup>
    
    <DirectoryRef Id='SequenceAssemblerFolder'>

      <!--Readme document-->
      <Component Id='ReadmeDocument' Guid='5CC442B8-E5AE-45D6-AA0E-40EE653E59C4'>
        <File Id='readme.txt' KeyPath='yes' Source='SourceDir\readme.txt'/>
        <RemoveFile Id='RemoveLogFiles' On='uninstall' Name='*.log'/>
      </Component>

      <!-- FASTA file type associations -->
      <!--create .fa file association-->
      <Component Id="Fasta_FaFileAssociation" DiskId="1" Guid="AD1AF347-E13A-4A63-B890-96318E42D744">
        <Condition>FASTA_FA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fa" Description="!(loc.Fasta_FaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fa" ContentType="application/fa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .mpfa file association-->
      <Component Id="Fasta_MpfaFileAssociation" DiskId="1" Guid="810B38DE-93EE-48BE-B55F-BFD691E25F70">
        <Condition>FASTA_MPFA</Condition>
        <ProgId Id="MSRSequenceAsssembler.mpfa" Description="!(loc.Fasta_MpfaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="mpfa" ContentType="application/mpfa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideMpfa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.mpfa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fna file association-->
      <Component Id="Fasta_FnaFileAssociation" DiskId="1" Guid="59547BD9-6088-40EC-B6F6-717594F530E3">
        <Condition>FASTA_FNA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fna" Description="!(loc.Fasta_FnaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fna" ContentType="application/fna">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFna" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fna\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .faa file association-->
      <Component Id="Fasta_FaaFileAssociation" DiskId="1" Guid="68F46BCC-7D1A-463F-ADBC-797F070F510D">
        <Condition>FASTA_FAA</Condition>
        <ProgId Id="MSRSequenceAsssembler.faa" Description="!(loc.Fasta_FaaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="faa" ContentType="application/faa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFaa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.faa\UserChoice"/>
        <CreateFolder/>
      </Component>
      
      <!--create .fsa file association-->
      <Component Id="Fasta_FsaFileAssociation" DiskId="1" Guid="EE8DEE14-07A9-4791-93AD-B63A939CBF97">
        <Condition>FASTA_FSA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fsa" Description="!(loc.Fasta_FsaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fsa" ContentType="application/fsa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFsa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fsa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fas file association-->
      <Component Id="Fasta_FasFileAssociation" DiskId="1" Guid="5BB43819-0E85-45E3-BE43-32FDB945D805">
        <Condition>FASTA_FAS</Condition>
        <ProgId Id="MSRSequenceAsssembler.fas" Description="!(loc.Fasta_FasFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fas" ContentType="application/fas">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFas" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fas\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fasta file association-->
      <Component Id="Fasta_FastaFileAssociation" DiskId="1" Guid="C1B92D4C-77F5-4B98-83F6-5536C745552F">
        <Condition>FASTA_FASTA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fasta" Description="!(loc.Fasta_FastaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fasta" ContentType="application/fasta">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFasta" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fasta\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- FASTQ file type associations -->
      <!--create .fq file association-->
      <Component Id="Fastq_FqFileAssociation" DiskId="1" Guid="6EEFD9BF-F110-4881-BD62-860D36A0F0BE">
        <Condition>FASTQ_FQ</Condition>
        <ProgId Id="MSRSequenceAsssembler.fq" Description="!(loc.Fastq_FqFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fq" ContentType="application/fq">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFq" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fq\UserChoice"/>
        <CreateFolder/>
      </Component>
      
      <!--create .fastq file association-->
      <Component Id="Fastq_FastqFileAssociation" DiskId="1" Guid="3765038B-505A-47BD-9AE2-74735032F50D">
        <Condition>FASTQ_FASTQ</Condition>
        <ProgId Id="MSRSequenceAsssembler.fastq" Description="!(loc.Fastq_FastqFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fastq" ContentType="application/fastq">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFastq" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fastq\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- GFF file type associations -->
      <!--create .gff file association-->
      <Component Id="GffFileAssociation" DiskId="1" Guid="2FCA36B6-3518-4FCA-9E13-E325EC92489A">
        <Condition>GFF_GFF</Condition>
        <ProgId Id="MSRSequenceAsssembler.gff" Description="!(loc.GffFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gff" ContentType="application/gff">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGff" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gff\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- GENBANK file type associations -->
      <!--create .gb file association-->
      <Component Id="Genbank_GbFileAssociation" DiskId="1" Guid="EBCF1DA1-C656-4444-8F97-C171966CF559">
        <Condition>GENBANK_GB</Condition>
        <ProgId Id="MSRSequenceAsssembler.gb" Description="!(loc.Genbank_GbFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gb" ContentType="application/gb">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGb" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gb\UserChoice" />
        <CreateFolder/>
      </Component>

      <!--create .gbk file association-->
      <Component Id="Genbank_GbkFileAssociation" DiskId="1" Guid="0B48DF81-1309-4ABE-98CF-4259D84AF8CA">
        <Condition>GENBANK_GBK</Condition>
        <ProgId Id="MSRSequenceAsssembler.gbk" Description="!(loc.Genbank_GbkFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gbk" ContentType="application/gbk">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGbk" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gbk\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .genbank file association-->
      <Component Id="Genbank_GenbankFileAssociation" DiskId="1" Guid="E0DB9264-FAEB-423C-AAAD-040C4016C256">
        <Condition>GENBANK_GENBANK</Condition>
        <ProgId Id="MSRSequenceAsssembler.genbank" Description="!(loc.Genbank_GenbankFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="genbank" ContentType="application/genbank">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGenbank" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.genbank\UserChoice"/>
        <CreateFolder/>
      </Component>

    </DirectoryRef>
    </Fragment>
</Wix>
